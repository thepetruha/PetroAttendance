<script>
    var dataJSON = {};
    var date1 = document.getElementById('date1');
    var date2 = document.getElementById('date2');
    var groupSelect = document.getElementById('GropSelect');


    var documentName1 = date1.value;
    var documentName2 = date2.value;
    var thisDate;
    

    date1.addEventListener('change', function(e){
        documentName1 = this.value;
    });

    date2.addEventListener('change', function(e){
        documentName2 = this.value;
    });

    

    
    var documentSelect = groupSelect.value;
    groupSelect.addEventListener('change', function(){
        documentSelect = this.value;
    })

    const { Document, Packer, Paragraph, Table, TableCell, TableRow, WidthType} = docx;
    function generate() {
        dataJSON = {
            dateWriteFirst: documentName1,
            dateWriteSecond: documentName2,
            groupSelect: documentSelect, 
            nameGroup: groupSelect.options[groupSelect.selectedIndex].text
        };    
        var tableRowArr = [];
        var jsDate = JSON.stringify(dataJSON);
        console.log(jsDate)
        fetch('http://localhost:4000/export', {
            method: 'POST', 
            headers: {
                'Content-Type': 'application/json'
            }, 
            body: jsDate
        }).then(result => {
            result.json()
            .then((datas) => {
                console.log(datas)
                let text = JSON.stringify(datas);
            })   
        })

        document.getElementById('link').classList.add('show');
    }

</script>
